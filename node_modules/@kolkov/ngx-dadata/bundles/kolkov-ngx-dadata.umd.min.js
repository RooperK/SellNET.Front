!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common/http"),require("rxjs"),require("rxjs/operators"),require("@angular/forms"),require("@angular/common")):"function"==typeof define&&define.amd?define("@kolkov/ngx-dadata",["exports","@angular/core","@angular/common/http","rxjs","rxjs/operators","@angular/forms","@angular/common"],e):e(((t=t||self).kolkov=t.kolkov||{},t.kolkov["ngx-dadata"]={}),t.ng.core,t.ng.common.http,t.rxjs,t.rxjs.operators,t.ng.forms,t.ng.common)}(this,(function(t,e,o,n,i,r,a){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var s;function u(t,e,o,n){var i,r=arguments.length,a=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,o,a):i(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a}(s=t.DadataType||(t.DadataType={})).fio="fio",s.address="address",s.party="party",s.bank="bank",s.email="email";var p=function(){function n(t){this.http=t,this.apiKey=""}return n.prototype.setApiKey=function(t){this.apiKey=t},n.prototype.getData=function(e,n,i){var r,a,s,u,p,c,l;void 0===n&&(n=t.DadataType.address);var d={headers:new o.HttpHeaders({Accept:"application/json","Content-Type":"application/json",Authorization:"Token "+this.apiKey})},h=Object.assign({},{query:e},{count:null===(r=i)||void 0===r?void 0:r.limit},{location:null===(a=i)||void 0===a?void 0:a.locations},{location_bust:null===(s=i)||void 0===s?void 0:s.locationsBoost},{from_bound:null===(p=null===(u=i)||void 0===u?void 0:u.bounds)||void 0===p?void 0:p.fromBound},{to_bound:null===(l=null===(c=i)||void 0===c?void 0:c.bounds)||void 0===l?void 0:l.toBound});return this.http.post("https://suggestions.dadata.ru/suggestions/api/4_1/rs/suggest/"+n,h,d)},n.ctorParameters=function(){return[{type:o.HttpClient}]},n.ɵprov=e["ɵɵdefineInjectable"]({factory:function(){return new n(e["ɵɵinject"](o.HttpClient))},token:n,providedIn:"root"}),n=u([e.Injectable({providedIn:"root"})],n)}(),c={apiKey:"",type:t.DadataType.address,delay:500,limit:10,width:"auto",minWidth:"0",partyAddress:"city",locations:null};var l=0,d=function(){function o(o,i,r){this.dataService=o,this.r=i,this.elRef=r,this.v="",this.currentFocus=-1,this.opened=!1,this.data=[],this.config=c,this.disabled=null,this.type=t.DadataType.address,this.limit=c.limit,this.placeholder="",this.locations=null,this.selected=new e.EventEmitter,this.inputString$=new n.Subject,this.id="ngx-dadata-"+l++,this.onTouched=function(){},this.propagateChange=function(){},this.validateFn=function(){}}var a;return a=o,Object.defineProperty(o.prototype,"value",{get:function(){return this.v},set:function(t){t!==this.v&&(this.v=t,this.propagateChange(t))},enumerable:!0,configurable:!0}),o.prototype.ngOnInit=function(){var t=this;this.type=this.config.type,this.locations=this.config.locations,this.dataService.setApiKey(this.apiKey?this.apiKey:this.config.apiKey),this.inputString$.pipe(i.debounce((function(){return n.timer(t.config.delay?t.config.delay:500)}))).subscribe((function(e){t.dataService.getData(e,t.type,t.config).subscribe((function(e){t.data=e.suggestions,t.data.length&&(t.opened=!0)}))}))},o.prototype.ngOnChanges=function(t){t.value},o.prototype.getData=function(t){this.inputString$.next(t),this.currentFocus=-1},o.prototype.onClick=function(t,e){this.inputValue.nativeElement.value=e.value,this.propagateChange(e.value),this.inputValue.nativeElement.focus(),this.selectedSuggestion=e,this.data=[],this.currentFocus=-1,this.opened=!1,this.selected.emit(e)},o.prototype.onOutsideClick=function(t){this.opened&&(this.elRef.nativeElement.contains(t.target)||(this.data=[],this.opened=!1))},o.prototype.onArrowDown=function(){this.removeFocus(this.currentFocus),this.currentFocus>=this.data.length-1?this.currentFocus=0:this.currentFocus++,this.setFocus(this.currentFocus)},o.prototype.onArrowUp=function(){this.removeFocus(this.currentFocus),0===this.currentFocus?this.currentFocus=this.data.length-1:this.currentFocus--,this.setFocus(this.currentFocus)},o.prototype.onEnter=function(t){this.selectedSuggestion=this.data[this.currentFocus],this.inputValue.nativeElement.value=this.selectedSuggestion.value,this.data=[],this.currentFocus=-1,this.propagateChange(this.selectedSuggestion.value),this.selected.emit(this.selectedSuggestion)},o.prototype.setFocus=function(t){var e=document.getElementById(t+"item");this.r.addClass(e,"active")},o.prototype.removeFocus=function(t){if(-1!==t){var e=document.getElementById(t+"item");this.r.removeClass(e,"active")}},o.prototype.writeValue=function(t){this.v=void 0!==t?t:"",this.r.setProperty(this.inputValue.nativeElement,"innerHTML",this.v)},o.prototype.registerOnChange=function(t){this.propagateChange=t},o.prototype.registerOnTouched=function(t){this.onTouched=t},o.prototype.setDisabledState=function(t){alert("disabled!"),this.disabled=t},o.ctorParameters=function(){return[{type:p},{type:e.Renderer2},{type:e.ElementRef}]},u([e.Input()],o.prototype,"config",void 0),u([e.Input()],o.prototype,"apiKey",void 0),u([e.Input()],o.prototype,"disabled",void 0),u([e.Input()],o.prototype,"type",void 0),u([e.Input()],o.prototype,"limit",void 0),u([e.Input()],o.prototype,"placeholder",void 0),u([e.Input()],o.prototype,"locations",void 0),u([e.Output()],o.prototype,"selectedSuggestion",void 0),u([e.Output()],o.prototype,"selected",void 0),u([e.ViewChild("inputValue",{static:!0})],o.prototype,"inputValue",void 0),u([e.HostListener("document:click",["$event"])],o.prototype,"onOutsideClick",null),o=a=u([e.Component({selector:"ngx-dadata",template:'<div class="autocomplete">\n  <input [disabled]="disabled  ? true : null" type="text" class="search" #inputValue (input)="getData(inputValue.value)"\n         [placeholder]="placeholder" (keyup.ArrowDown)="onArrowDown()" (keyup.ArrowUp)="onArrowUp()"\n         (keyup.Enter)="onEnter($event)" spellcheck="false" [(ngModel)]="value" autocomplete="off" />\n  <div *ngIf="data.length">\n    <div class="autocomplete-items">\n      <div class="autocomplele-item" *ngFor="let item of data; let i = index" (click)="onClick($event, item)" [id]="i+\'item\'">\n        {{item.value}}\n        <ng-template [ngIf]="type===\'party\'">\n          <br/>\n          <span>{{item.data?.inn}} {{config.partyAddress === \'full\' ? item.data?.address?.value : item.data?.address?.data?.city}}</span>\n        </ng-template>\n      </div>\n    </div>\n  </div>\n</div>\n',providers:[{provide:r.NG_VALUE_ACCESSOR,useExisting:e.forwardRef((function(){return a})),multi:!0}],styles:[".autocomplete{position:relative}input{border:0 solid transparent;background-color:#ffffff;padding:5px}input[type=text]{background-color:#ffffff;width:100%}input[type=submit]{background-color:#1e90ff;color:#fff}.autocomplete-items{position:absolute;border:1px solid #d4d4d4;border-bottom:none;border-top:none;z-index:99;top:100%;left:0;right:0}.autocomplete-items .autocomplele-item{padding:5px 10px;cursor:pointer;background-color:#fff;border-bottom:1px solid #d4d4d4}.autocomplete-items .autocomplele-item:hover{background-color:#e9e9e9}.autocomplete-items .autocomplele-item.active{background-color:#1e90ff!important;color:#fff}.autocomplete-items .autocomplele-item span{color:#555;font-size:80%}"]})],o)}(),h=function(){function t(){}return t=u([e.NgModule({imports:[a.CommonModule,r.FormsModule],declarations:[d],exports:[d]})],t)}();t.DadataConfigDefault=c,t.NgxDadataComponent=d,t.NgxDadataModule=h,t.NgxDadataService=p,t.createDaDataValidator=function(t){return function(e){var o={rangeError:{given:e.value,expected:t}};return e.value!==t?o:null}},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=kolkov-ngx-dadata.umd.min.js.map
